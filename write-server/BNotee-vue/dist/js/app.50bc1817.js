(function(){"use strict";var e={534:function(e,t,o){var s=o(9963),i=o(6252),n=o(3577);function l(e,t,o,s,l,a){const c=(0,i.up)("tool-bar"),d=(0,i.up)("uploader"),r=(0,i.up)("control-balls"),h=(0,i.up)("msgbar"),u=(0,i.up)("note"),p=(0,i.up)("fixed-components"),m=(0,i.up)("anchors");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,n.C_)(["dark-filter",{darken:l.isDarkMode}])},null,2),(0,i.Wm)(c,{isTouchMode:l.isTouchMode},null,8,["isTouchMode"]),(0,i.Wm)(d),(0,i.Wm)(r,{isDarkMode:l.isDarkMode,isTouchMode:l.isTouchMode,isFullscreen:l.isFullscreen,onToggleDarkMode:t[0]||(t[0]=e=>l.isDarkMode=!l.isDarkMode),onToggleTouchMode:t[1]||(t[1]=e=>l.isTouchMode=!l.isTouchMode),onToggleFullscreen:t[2]||(t[2]=e=>l.isFullscreen=!l.isFullscreen)},null,8,["isDarkMode","isTouchMode","isFullscreen"]),(0,i.Wm)(h),(0,i.Wm)(u,{isFullscreen:l.isFullscreen,isTouchMode:l.isTouchMode},null,8,["isFullscreen","isTouchMode"]),(0,i.Wm)(p),(0,i.Wm)(m)],64)}const a=e=>((0,i.dD)("data-v-2eb990b0"),e=e(),(0,i.Cn)(),e),c={class:"toolbar shadow-3"},d={class:"logo shadow-2"},r=a((()=>(0,i._)("i",{class:"material-icons"},"info_outline",-1))),h=[r],u=a((()=>(0,i._)("i",{class:"material-icons"},"format_list_bulleted",-1))),p=[u],m={class:"tools"},f=a((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),b=[f],g=a((()=>(0,i._)("i",{class:"material-icons"},"remove",-1))),v=[g],w=a((()=>(0,i._)("i",{class:"material-icons"},"indeterminate_check_box",-1))),T=[w],C=a((()=>(0,i._)("i",{class:"material-icons"},"color_lens",-1))),_=[C],k=a((()=>(0,i._)("i",{class:"material-icons"},"clear_all",-1))),N=[k],y=a((()=>(0,i._)("i",{class:"material-icons"},"cloud_upload",-1))),x=[y],L=a((()=>(0,i._)("i",{class:"material-icons"},"vertical_align_bottom",-1))),M=[L],j={class:"material-icons file"},D={ref:"fileUploader",type:"file",accept:"application/json"};function S(e,t,o,l,a,r){const u=(0,i.up)("info");return(0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(u,{disabled:!a.isInfoWindowShow},null,8,["disabled"]),(0,i._)("div",d,[(0,i._)("div",{class:(0,n.C_)(["info-outer",{disabled:!a.isInfoIconShow}]),onClick:t[0]||(t[0]=e=>a.isInfoWindowShow=!0)},h,2),(0,i._)("div",{class:"logo-outer",onClick:t[1]||(t[1]=(...e)=>r.logoClick&&r.logoClick(...e))},p)]),(0,i._)("div",m,[(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[2]||(t[2]=(...e)=>r.openTextfield&&r.openTextfield(...e))},b,2),(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[3]||(t[3]=(...e)=>r.toDeleteNode&&r.toDeleteNode(...e))},v,2),(0,i.wy)((0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!r.selectedNode.loc}]),onClick:t[4]||(t[4]=(...e)=>r.nodeCancelSelect&&r.nodeCancelSelect(...e))},T,2),[[s.F8,o.isTouchMode]]),(0,i._)("div",{class:(0,n.C_)(["tool btn btn-shallow",{disabled:!["h1","h2","h3","h4","p","li"].includes(r.selectedNode.type)}]),onClick:t[5]||(t[5]=(...e)=>r.openColors&&r.openColors(...e))},_,2),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[6]||(t[6]=(...e)=>r.clearNodes&&r.clearNodes(...e))},N),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[7]||(t[7]=(...e)=>r.openUploader&&r.openUploader(...e))},x),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[8]||(t[8]=(...e)=>r.saveNote&&r.saveNote(...e)),onContextmenu:t[9]||(t[9]=(0,s.iM)(((...e)=>r.saveMarkdown&&r.saveMarkdown(...e)),["prevent"]))},M,32),(0,i._)("div",{class:"tool btn btn-shallow",onClick:t[10]||(t[10]=(...e)=>r.readNote&&r.readNote(...e))},[(0,i._)("i",j,[(0,i.Uk)("input "),(0,i._)("input",D,null,512)])])])])}const O=e=>((0,i.dD)("data-v-e14e41c8"),e=e(),(0,i.Cn)(),e),F={class:"info-outer"},I=O((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),$=[I],E=O((()=>(0,i._)("div",{class:"info"},[(0,i._)("h1",null,"关于 | About"),(0,i._)("hr"),(0,i._)("h2",null,"此 | This"),(0,i._)("p",null," 一个运行在浏览器上的笔记程序。| A notebook application works on your Browser. "),(0,i._)("hr"),(0,i._)("h2",null,"作者 | Author"),(0,i._)("p",null,[(0,i.Uk)(" GitHub: "),(0,i._)("a",{href:"https://github.com/BHznJNs",target:"_blank"},"https://github.com/BHznJNs"),(0,i._)("br"),(0,i.Uk)(" BiliBili: "),(0,i._)("a",{href:"https://space.bilibili.com/274945998",target:"_blank"},"https://space.bilibili.com/274945998"),(0,i._)("br")]),(0,i._)("hr"),(0,i._)("h2",null,"框架 | Framework"),(0,i._)("p",null,[(0,i.Uk)(" Vue.js "),(0,i._)("a",{href:"https://v3.cn.vuejs.org/",target:"_blank"},"https://v3.cn.vuejs.org/"),(0,i._)("br"),(0,i.Uk)(" MDUI "),(0,i._)("a",{href:"https://www.mdui.org/",target:"_blank"},"https://www.mdui.org/")])],-1)));function A(e,t,o,s,n,l){const a=(0,i.up)("window");return(0,i.wg)(),(0,i.j4)(a,{width:"800px",height:"480px",disabled:o.disabled,onClose:l.close},{default:(0,i.w5)((()=>[(0,i._)("div",F,[(0,i._)("div",{class:"closer shadow-1",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e))},$),E])])),_:1},8,["disabled","onClose"])}const W={class:"window-outer"};function R(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["window-container",{disabled:o.disabled}])},[(0,i._)("div",{class:"fullscreen-mask",onClick:t[0]||(t[0]=(...e)=>a.close&&a.close(...e))}),(0,i._)("div",W,[(0,i._)("div",{class:"window shadow-16",style:(0,n.j5)({width:o.width,height:o.height})},[(0,i.WI)(e.$slots,"default",{},void 0,!0)],4)])],2)}var Z={props:["width","height","disabled"],methods:{close(){this.$emit("close")}}},H=o(3744);const U=(0,H.Z)(Z,[["render",R],["__scopeId","data-v-4224fe13"]]);var B=U,K={components:{Window:B},props:["disabled"],methods:{close(){this.$parent.isInfoWindowShow=!1}}};const V=(0,H.Z)(K,[["render",A],["__scopeId","data-v-e14e41c8"]]);var Y=V,G={inject:["note"],computed:{getThisObj(){if(!this.location)return;let e;return this.getNodeObj({location:this.location,callback:(t,o)=>{e=t[o]}}),e}},methods:{getNodeObj({parentObj:e=this.note,location:t,num:o=0,callback:s}){o==t.length-1?s&&s(e.CTS,t[o]):this.getNodeObj({parentObj:e.CTS[t[o]],location:t,num:o+1,callback:s})}}};const z=G;var P=z,J={methods:{insertNode(e,t){e&&t&&this.getNodeObj({location:t,callback:(t,o)=>{t.splice(o+1,0,e)}})}}},q={methods:{deleteNode(e){let t;return this.selectedNode.vnode&&(this.selectedNode.loc=null,this.selectedNode.type="",this.selectedNode.vnode=null,this.selectedNode.obj=null),this.getNodeObj({location:e,callback:(e,o)=>{t=e[o],e.splice(o,1)}}),t}}},Q=o(9473);function X(e,t){function o(e,t){const s="    ".repeat(t),i=e.OL,n=i?"1. ":"- ",l=e.CTS;let a="";for(const c of l)"li"==c.NT?a+=s+n+c.CT+"\n\n":a+=o(c,t+1);return a}const s=e.CT;let i,n=!1,l=!1;switch(e.NT){case"h":i="#".repeat(t)+s;break;case"hr":i="* * *";break;case"p":i="  ".repeat(t-1)+s;break;case"img":case"link":i=`[${s}](${e.SRC})`;break;case"floor":n=!0,i=ee(e.CTS,t+1);break;case"list":n=!0,i=o(e,0),l=!0;break;case"table":i=(0,Q.x)(e.CTS),l=!0;break;case"details":i=`> ${e.SUM}`;for(const t of e.CTS)i+="\n\n>> "+t.CT;l=!0;break;case"code":i=`\`\`\`${e.LG}\n${e.CT}\n\`\`\``;break;default:return console.log("Unknown node type: "+e.NT),""}return n||(i+="\n\n"),l&&(i+="\n"),i}function ee(e,t){let o="";for(const s of e)o+=X(s,t);return o}var te=e=>{const t=e.CTS;return ee(t,1)},oe=o(9391),se=new oe.Z,ie=o(3162),ne=o.n(ie),le={data(){return{isInfoIconShow:!1,isInfoWindowShow:!1}},props:["isTouchMode"],inject:["note","selectedNode"],components:{Info:Y},mixins:[P,J,q],mounted(){const e=this.$refs.fileUploader;e.addEventListener("change",(()=>{let t=new FileReader;t.readAsText(e.files[0],"uft8"),t.onload=e=>{let t=e.target.result;this.note.CTS=JSON.parse(t),se.emit("note-loaded")}})),se.on("textfield-return-toolBar",(e=>{this.toInsertNode(e)}))},methods:{logoClick(){this.isInfoIconShow=!0,setTimeout((()=>{this.isInfoIconShow=!1}),3e3)},openTextfield(){se.emit("textfield-open","toolBar")},toInsertNode(e){const t=Array.from(this.selectedNode.loc);this.insertNode(e,t),t[t.length-1]+=1,se.emit("add-history",{loc:t,prop:"IST"})},toDeleteNode(){const e=this.selectedNode.loc,t=this.deleteNode(e);e[e.length-1]-=1,se.emit("add-history",{loc:e,prop:"DEL",nodeObj:t})},nodeCancelSelect(){this.selectedNode.vnode.selected=!1,this.selectedNode.loc=null,this.selectedNode.obj=null,this.selectedNode.type=null},openColors(){se.emit("fixedComponents-open","colors")},clearNodes(){this.note.CTS=[],this.note.HT=[],se.emit("clear-history")},openUploader(){se.emit("open-uploader")},saveNote(){let e=new Blob([JSON.stringify(this.note.CTS)],{type:"text/plain;charset=utf-8"});const t=this.note.NM||"MyNote";ne()(e,t+".json")},saveMarkdown(){const e=te(this.note);let t=new Blob([e],{type:"text/plain;charset=utf-8"});const o=this.note.NM||"MyNote";ne()(t,o+".md")},readNote(){const e=this.$refs.fileUploader;e.click()}}};const ae=(0,H.Z)(le,[["render",S],["__scopeId","data-v-2eb990b0"]]);var ce=ae;const de=e=>((0,i.dD)("data-v-68cfcc62"),e=e(),(0,i.Cn)(),e),re=de((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),he=[re];function ue(e,t,o,l,a,c){const d=(0,i.up)("floor-block"),r=(0,i.up)("node-renderer"),h=(0,i.up)("textfield-group");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["note-outer shadow-4",{fullscreen:o.isFullscreen}])},[(0,i._)("div",{class:"note",ref:"note",onContextmenu:t[1]||(t[1]=(0,s.iM)((()=>{}),["prevent"]))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.note.CTS,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["floor"==e.NT?((0,i.wg)(),(0,i.j4)(d,{key:0,children:e.CTS,level:2,location:[t]},null,8,["children","location"])):((0,i.wg)(),(0,i.j4)(r,{key:1,level:1,nodeObj:e,location:[t]},null,8,["nodeObj","location"]))],64)))),128)),(0,i.Wm)(h,{id:"note-textfield-group",ref:"textfield",isAdding:a.isNodeAdding,onReturnNode:c.closeNodeAdder},null,8,["isAdding","onReturnNode"]),(0,i._)("div",{class:(0,n.C_)(["btn-fab adder-btn",{disabled:a.isNodeAdding,fullscreen:o.isFullscreen}]),onClick:t[0]||(t[0]=(...e)=>c.openNodeAdder&&c.openNodeAdder(...e))},he,2)],544)],2)}o(7658);const pe=["#","`","_","/","-",":"],me={"##":"strong","``":"code",__:"u","//":"i","--":"del","::":"span"};function fe(e){const t=[];let o="",s="";for(let i of e)pe.includes(i)?i==s?(t.push({type:"text",content:o.slice(0,-1)}),t.push({type:"key",content:i.repeat(2)}),s="",o=""):(o+=i,s=i):(s.length&&(s=""),o+=i);return o.length&&t.push({type:"text",content:o}),t}function be(e){const t=[];let o="",s="",i="";for(let n of e){const e=n.content;if(o+=e,"key"==n.type)if("key"==s){if(e!=i)continue;const n=me[e];t.push({tagName:n,content:o}),s="",o=""}else s="key",i=e;else"key"!=s&&(t.push({tagName:"text",content:o}),o="")}if(o.length){const e=t[t.length-1];e.content+=o}return t}function ge(e,t){return`<${e}>${t}</${e}>`}function ve(e){const t=[];for(let o of e)"text"==o.tagName?t.push(o.content):t.push(ge(o.tagName,o.content));return t}function we(e){if(!e)return null;const t=fe(e),o=be(t);let s;s=ve(o);const i=s.join("");return i}async function Te(){const e=document.getElementsByClassName("inline-style");for(let t of e){const e=t.textContent;if(!e)continue;const o=we(e,"HTML");t.innerHTML=o}}var Ce={outputer:we,init:Te};const _e=(0,i._)("div",{class:"mask"},null,-1);function ke(e,t,o,s,l,a){const c=(0,i.up)("floor-block",!0),d=(0,i.up)("node-renderer"),r=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["floor shadow-1",{"shadow-3":l.selected,"touch-mode":a.isTouchMode}]),onMouseenter:t[0]||(t[0]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[1]||(t[1]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[_e,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["floor"==e.NT?((0,i.wg)(),(0,i.j4)(c,{key:0,children:e.CTS,level:o.level+1,location:o.location.concat([t])},null,8,["children","level","location"])):((0,i.wg)(),(0,i.j4)(d,{key:1,nodeObj:e,level:o.level,location:o.location.concat([t])},null,8,["nodeObj","level","location"]))],64)))),128)),(0,i.Wm)(r,{disabled:!e.hover,isTouchMode:a.isTouchMode,selected:l.selected,location:o.location,parentType:"floor"},null,8,["disabled","isTouchMode","selected","location"])],34)}var Ne={methods:{selectEvent(){this.selected?(se.emit("fixedComponents-close"),this.selectedNode.loc=null,this.selectedNode.vnode=null,this.selectedNode.obj=null,this.selectedNode.type=null,this.selected=!1):(this.selectedNode.loc&&(this.selectedNode.vnode.selected=!1),this.selectedNode.loc=this.location,this.selectedNode.vnode=this,this.selectedNode.obj=this.getThisObj,this.selectedNode.type=this.tagName,this.selected=!0)}}},ye={data(){return{selected:!1,initialContent:"",editing:!1,dbTouch:!1}},inject:["selectedNode"],mixins:[P,Ne],props:["tagName","content","location","color"],watch:{content(e){this.$nextTick((()=>{const t=Ce.outputer(e);this.$el.innerHTML=t}))}},render(){return(0,i.h)(this.tagName,{contentEditable:!0,class:{selected:this.selected,editing:this.editing,"inline-style":!0},style:{color:this.color},onContextmenu:e=>{e.preventDefault(),this.initialContent||(this.initialContent=e.target.innerText),this.selectEvent()},onTouchstart:()=>{this.dbTouch&&this.selectEvent(),this.dbTouch=!0,setTimeout((()=>{this.dbTouch=!1}),300)},onClick:()=>{this.editing||(this.initialContent=this.$el.innerText),this.editing=!0},onBlur:e=>{const t=e.target.innerText;t!=this.initialContent&&(this.getThisObj.CT=t,se.emit("add-history",{loc:this.location,prop:"CT",before:this.initialContent,after:t}),this.initialContent=t),this.editing=!1}},this.content)}};const xe=ye;var Le=xe,Me={props:["level","content","location","color"],components:[Le],mounted(){this.$nextTick((()=>{se.emit("anchor-mounted")}))},render(){let e;return e=this.level<6?"h"+this.level:"h5",(0,i.h)(Le,{tagName:e,id:this.location.join(""),class:"heading",content:this.content,color:this.color,location:this.location})}};const je=Me;var De=je;const Se=e=>((0,i.dD)("data-v-eaaa2d3a"),e=e(),(0,i.Cn)(),e),Oe=["src","alt"],Fe=Se((()=>(0,i._)("hr",{class:"image-divider"},null,-1)));function Ie(e,t,o,l,a,c){const d=(0,i.up)("basic-node");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)({image:!0,selected:a.selected}),onContextmenu:t[2]||(t[2]=(...t)=>e.selectEvent&&e.selectEvent(...t))},[(0,i._)("img",{class:(0,n.C_)({image:!0,reverse:a.reverse}),onClick:t[0]||(t[0]=(...e)=>c.openImage&&c.openImage(...e)),onError:t[1]||(t[1]=(...e)=>c.imgLoadErr&&c.imgLoadErr(...e)),src:this.source,alt:this.alt},null,42,Oe),Fe,(0,i.wy)((0,i.Wm)(d,{class:"alt-content",tagName:"p",color:"#333",location:this.location,content:this.alt},null,8,["location","content"]),[[s.F8,!this.isLoadErr]])],34)}var $e={data(){return{reverse:!1,selected:!1,isLoadErr:!1,source:"/imgs/"+this.src}},props:["alt","src","location"],components:{BasicNode:Le},inject:["selectedNode","isDarkMode"],mixins:[Ne],methods:{imgLoadErr(){this.isLoadErr=!0,alert("图片获取失败: "+this.src)},openImage(){window.open(this.source)}},watch:{isDarkMode(e){this.reverse=e}}};const Ee=(0,H.Z)($e,[["render",Ie],["__scopeId","data-v-eaaa2d3a"]]);var Ae=Ee,We={data(){return{selected:!1,initialContent:"",editing:!1,dbRightClick:!1}},inject:["selectedNode"],mixins:[P,Ne],props:["tagName","content","location","color","href"],render(){return(0,i.h)(this.tagName,{contentEditable:!0,href:this.href,target:"_blank",class:{selected:this.selected,editing:this.editing,"inline-style":!0},style:{color:this.color},onClick:e=>{e.preventDefault(),window.open(this.href),this.$el.blur()},onContextmenu:e=>{e.preventDefault(),this.dbRightClick?this.selectEvent():(this.dbRightClick=!0,setTimeout((()=>{this.dbRightClick=!1}),300),this.editing||(this.initialContent=e.target.innerText),this.editing=!0)},onBlur:e=>{const t=e.target.innerText;t!=this.initialContent&&(this.getThisObj.CT=t,se.emit("add-history",{loc:this.location,prop:"CT",before:this.initialContent,after:t}),this.initialContent=t),this.editing=!1}},this.content)}};const Re=We;var Ze=Re;const He=(0,i._)("div",{class:"mask"},null,-1),Ue=(0,i._)("i",{class:"material-icons"},"playlist_add",-1),Be=[Ue],Ke={class:"material-icons"},Ve={class:"material-icons"};function Ye(e,t,o,l,a,c){const d=(0,i.up)("list-block",!0),r=(0,i.up)("basic-node"),h=(0,i.up)("list-child"),u=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["list",{"shadow-2":a.selected,hover:e.hover,empty:!o.children.length,"touch-mode":c.isTouchMode,nested:a.isNested}]),onMouseenter:t[2]||(t[2]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[He,(0,i.Wm)(h,{ordered:o.isOrdered},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((t,s)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:t.id},["list"==t.NT?((0,i.wg)(),(0,i.j4)(d,{key:0,isOrdered:t.OL,children:t.CTS,location:o.location.concat([s]),onMouseInChild:e.onMouseLeave},null,8,["isOrdered","children","location","onMouseInChild"])):((0,i.wg)(),(0,i.j4)(r,{key:1,tagName:"li",content:t.CT,color:t.CL,location:o.location.concat([s])},null,8,["content","color","location"]))],64)))),128))])),_:1},8,["ordered"]),(0,i.Wm)(u,{disabled:!e.hover,isTouchMode:c.isTouchMode,selected:a.selected,location:o.location,parentType:"list"},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...e)=>c.addListBlock&&c.addListBlock(...e))},Be),(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[1]||(t[1]=(...e)=>c.toggleOrdered&&c.toggleOrdered(...e))},[(0,i.wy)((0,i._)("i",Ke,"format_list_bulleted",512),[[s.F8,o.isOrdered]]),(0,i.wy)((0,i._)("i",Ve,"format_list_numbered",512),[[s.F8,!o.isOrdered]])])])),_:1},8,["disabled","isTouchMode","selected","location"])],34)}const Ge=e=>((0,i.dD)("data-v-04fa293f"),e=e(),(0,i.Cn)(),e),ze=Ge((()=>(0,i._)("i",{class:"material-icons"},"add",-1))),Pe=[ze],Je={class:"checkbox"},qe=["checked"];function Qe(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["controls",{disabled:o.disabled&&!o.isTouchMode,"touch-mode":o.isTouchMode}])},[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...t)=>e.addNode&&e.addNode(...t))},Pe),(0,i.WI)(e.$slots,"default",{},void 0,!0),(0,i._)("label",Je,[(0,i._)("input",{type:"checkbox",ref:"checkbox",checked:o.selected,onChange:t[1]||(t[1]=(...e)=>a.selectEvent&&a.selectEvent(...e))},null,40,qe),(0,i._)("i",{class:"checkbox-icon",onTouchstart:t[2]||(t[2]=(...e)=>a._touchstart&&a._touchstart(...e)),onTouchend:t[3]||(t[3]=(...e)=>a._touchend&&a._touchend(...e))},null,32)])],2)}var Xe={methods:{tableAdder(e){const t=e.length,o=e[0].length;let s=[];for(let i=0;i<o;i++)s.push("");e.push(s),se.emit("add-history",{loc:this.location,prop:"ROW",before:t,after:t+1})},detailAdder(e){e.push({CT:"",CL:"#333"});const t=Object.create(this.location);t.push(e.length-1),se.emit("add-history",{loc:t,prop:"IST"})},listAdder(e){e.push({NT:"li",CT:"",CL:"#333"});const t=Object.create(this.location);t.push(e.length-1),se.emit("add-history",{loc:t,prop:"IST"})},floorAdder(e){se.off("textfield-return-"+this.parentType),se.on("textfield-return-"+this.parentType,(t=>{t&&e.push(t);const o=Array.from(this.location);o.push(e.length-1),se.emit("add-history",{loc:o,prop:"IST"}),se.off("textfield-return-"+this.parentType)})),se.emit("textfield-open",this.parentType)},addNode(){const e=this.getThisObj.CTS;switch(this.parentType){case"table":this.tableAdder(e);break;case"details":this.detailAdder(e);break;case"list":this.listAdder(e);break;case"floor":this.floorAdder(e)}}}},et={data(){return{timeout:null}},props:["isTouchMode","parentType","disabled","location","selected"],inject:["selectedNode"],mixins:[P,Xe],methods:{_touchstart(){this.timeout=setTimeout((()=>{this.addNode()}),1e3)},_touchend(){clearTimeout(this.timeout)},selectEvent(){const e=this.$refs.checkbox.checked;this.$parent.selected=e,e?(this.selectedNode.loc&&(this.selectedNode.vnode.selected=!1),this.selectedNode.loc=this.location,this.selectedNode.vnode=this.$parent,this.selectedNode.type=this.parentType,"list"==this.parentType&&(this.selectedNode.type=this.$parent.isNested?"nestedList":"notNestedList")):(this.selectedNode.loc=null,this.selectedNode.vnode=null,this.selectedNode.type=null)}}};const tt=(0,H.Z)(et,[["render",Qe],["__scopeId","data-v-04fa293f"]]);var ot=tt,st={data(){return{hover:!1,setTimeout:null}},methods:{onMouseEnter(){this.setTimeout=setTimeout((()=>{this.hover=!0}),400)},onMouseLeave(){clearTimeout(this.setTimeout),this.selected||(this.hover=!1)}}},it={name:"list-block",data(){return{selected:!1,isNested:null}},components:{BasicNode:Le,BlockControls:ot,listChild:{props:["ordered"],render(){return(0,i.h)(this.ordered?"ol":"ul",this.$slots.default())}}},props:["children","isOrdered","location"],inject:["isTouchMode"],mixins:[P,st],methods:{addListBlock(){const e=this.getThisObj.CTS;e.push({NT:"list",OL:!1,CTS:[{NT:"li",CT:"",CL:"#333"}]});const t=Object.create(this.location);t.push(e.length-1),se.emit("add-history",{loc:t,prop:"IST"})},toggleOrdered(){this.getThisObj.OL=!this.getThisObj.OL}},mounted(){const e=this.$el.parentNode;this.isNested="OL"==e.tagName||"UL"==e.tagName}};const nt=(0,H.Z)(it,[["render",Ye]]);var lt=nt;const at=(0,i._)("div",{class:"mask"},null,-1),ct=(0,i._)("i",{class:"material-icons"},"grid_on",-1),dt=[ct];function rt(e,t,o,s,l,a){const c=(0,i.up)("table-row"),d=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["table shadow-1",{"shadow-3":l.selected,"touch-mode":a.isTouchMode,hover:e.hover&&!a.isTouchMode}]),onMouseenter:t[1]||(t[1]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[2]||(t[2]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[at,(0,i._)("table",null,[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.j4)(c,{key:e.id,children:e,location:o.location.concat(t)},null,8,["children","location"])))),128))])]),(0,i.Wm)(d,{isTouchMode:a.isTouchMode,disabled:!e.hover,selected:l.selected,location:o.location,parentType:"table"},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"btn btn-normal tool-btn-in-block",onClick:t[0]||(t[0]=(...e)=>a.openTableSetter&&a.openTableSetter(...e))},dt)])),_:1},8,["isTouchMode","disabled","selected","location"])],34)}const ht=["onBlur"];function ut(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("tr",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,o)=>((0,i.wg)(),(0,i.iD)("td",{key:e.id,onClick:t[0]||(t[0]=(...e)=>a.edit&&a.edit(...e)),onContextmenu:t[1]||(t[1]=(...e)=>a.edit&&a.edit(...e)),onBlur:e=>a.finishEdit(e,o),contenteditable:"true"},(0,n.zw)(e),41,ht)))),128))])}var pt={mixins:[P],props:["children","location"],methods:{edit(e){let t=e.target;t.classList.add("editing")},finishEdit(e,t){let o=e.target;o.classList.remove("editing");let s=o.innerText;this.getThisObj[t]=s}}};const mt=(0,H.Z)(pt,[["render",ut]]);var ft=mt,bt={data(){return{selected:!1}},props:["children","location"],inject:["isTouchMode"],mixins:[st],components:{TableRow:ft,BlockControls:ot},methods:{openTableSetter(){se.emit("fixedComponents-open","tableSetter"),se.emit("table-location",this.location)}}};const gt=(0,H.Z)(bt,[["render",rt]]);var vt=gt;function wt(e,t,o,s,l,a){const c=(0,i.up)("basic-node"),d=(0,i.up)("block-controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["details",{"shadow-2":l.selected,hover:e.hover,"touch-mode":a.isTouchMode}]),onMouseenter:t[2]||(t[2]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[(0,i._)("summary",{class:"summary",contenteditable:"true",ref:"summary",onBlur:t[0]||(t[0]=(...e)=>a.finishEdit&&a.finishEdit(...e))},(0,n.zw)(o.summary),545),(0,i._)("details",null,[(0,i._)("summary",{onContextmenu:t[1]||(t[1]=t=>e.$refs.summary.focus()),style:{"line-height":"1.4"}},null,32),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.children,((e,t)=>((0,i.wg)(),(0,i.j4)(c,{key:e.id,tagName:"p",content:e.CT,color:e.CL,location:o.location.concat([t])},null,8,["content","color","location"])))),128))]),(0,i.Wm)(d,{disabled:!e.hover,isTouchMode:a.isTouchMode,selected:l.selected,location:o.location,parentType:"details"},null,8,["disabled","isTouchMode","selected","location"])],34)}var Tt={data(){return{selected:!1}},components:{BasicNode:Le,BlockControls:ot},mixins:[P,st],inject:["isTouchMode"],props:["children","summary","location"],methods:{finishEdit(e){const t=e.target,o=t.innerText;se.emit("add-history",{loc:this.location,prop:"SUM",before:this.getThisObj.SUM,after:o}),this.getThisObj.SUM=o}}};const Ct=(0,H.Z)(Tt,[["render",wt],["__scopeId","data-v-7df230aa"]]);var _t=Ct;function kt(e,t,o,s,n,l){const a=(0,i.up)("highlightjs");return t[0]||((0,i.qZ)(-1),t[0]=(0,i.Wm)(a,{code:o.code,language:o.language,autodetect:!1,onFocusout:l.render,onContextmenu:l.select,tabindex:"0"},null,8,["code","language","onFocusout","onContextmenu"]),(0,i.qZ)(1),t[0])}var Nt=o(8783),yt=o(1073);function xt(e,t="end"){const o=window.getSelection(),s=o.getRangeAt(0),i=document.createTextNode(e);s.insertNode(i),"start"==t?o.collapseToStart():"end"==t?o.collapseToEnd():console.warn("Unknown direction type!")}function Lt(e){e.preventDefault(),xt("    ")}const Mt=new Map([[")","("],["]","["],["}","{"],[">","<"]]),jt=["html","xml","xhtml","svg","rss"];function Dt(e,t){setTimeout((()=>{t?(xt(`${Mt.get(e)}\n    `),xt(`\n${e}`,"start")):xt(e,"start")}),150)}var St={methods:{codeInput(e){switch(e.keyCode){case 9:Lt(e);break;case 57:e.shiftKey&&Dt(")",e.altKey);break;case 219:e.shiftKey?Dt("}",e.altKey):Dt("]",e.altKey);break;case 188:jt.includes(this.language)&&Dt(">");break;case 222:e.shiftKey?Dt('"'):Dt("'");break;case 192:Dt("`",e.altKey);break}}}},Ot={data(){return{tagName:"code",codeNode:null,selected:!1}},components:{highlightjs:yt.Z.component},mixins:[P,Ne,St],inject:["selectedNode"],props:["language","code","location"],watch:{code(e){this.codeNode.innerHTML=e,Nt.Z.highlightElement(this.codeNode)}},methods:{render(){let e=this.codeNode.innerText;e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");const t=this.getThisObj.CT,o=e;o!=t&&(se.emit("add-history",{loc:this.location,prop:"CT",before:this.getThisObj.CT,after:e}),this.getThisObj.CT=e)},select(){this.selectEvent(),this.codeNode.classList.toggle("selected",this.selected)}},mounted(){this.codeNode=this.$el.querySelector("code"),this.codeNode.contentEditable=!0,this.codeNode.addEventListener("keydown",this.codeInput),this.$nextTick((()=>{this.codeNode.innerHTML=this.code,Nt.Z.highlightElement(this.codeNode)}))}};const Ft=(0,H.Z)(Ot,[["render",kt]]);var It=Ft,$t={props:["nodeObj","level","location"],render(){let e,t={location:this.location};switch(this.nodeObj.NT){case"h":e=De,t.level=this.level,t.content=this.nodeObj.CT,t.color=this.nodeObj.CL;break;case"img":e=Ae,t.src=this.nodeObj.SRC,t.alt=this.nodeObj.CT;break;case"link":e=Ze,t.tagName="a",t.content=this.nodeObj.CT,t.color=this.nodeObj.CL,t.href=this.nodeObj.SRC;break;case"list":e=lt,t.isOrdered=this.nodeObj.OL,t.children=this.nodeObj.CTS;break;case"table":e=vt,t.children=this.nodeObj.CTS;break;case"details":e=_t,t.summary=this.nodeObj.SUM,t.children=this.nodeObj.CTS;break;case"code":e=It,t.language=this.nodeObj.LG,t.code=this.nodeObj.CT;break;default:e=Le,t.tagName=this.nodeObj.NT,t.content=this.nodeObj.CT,t.color=this.nodeObj.CL}return(0,i.h)(e,t)}};const Et=$t;var At=Et,Wt={name:"floor-block",components:{BlockControls:ot,NodeRenderer:At},data(){return{selected:!1}},props:["level","location","children"],inject:["isTouchMode"],mixins:[st]};const Rt=(0,H.Z)(Wt,[["render",ke]]);var Zt=Rt;const Ht=(0,i.uE)('<option value="h">标题</option><option value="p">段落</option><option value="img">图片</option><option value="link">链接</option><option value="hr">割线</option><option value="floor">层次</option><option value="ol">序列</option><option value="ul">乱列</option><option value="code">代码</option><option value="table">表格</option><option value="details">详情</option>',11),Ut=[Ht],Bt=(0,i._)("i",{class:"material-icons"},"close",-1),Kt=[Bt];function Vt(e,t,o,l,a,c){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["textfield-group shadow-2",{disabled:!o.isAdding}])},[(0,i._)("input",{onChange:t[0]||(t[0]=(...t)=>e.imgRevFunc&&e.imgRevFunc(...t)),type:"file",ref:"imgRev",style:{display:"none"}},null,544),(0,i._)("select",{onChange:t[1]||(t[1]=(...e)=>c.focus&&c.focus(...e)),class:"selector",ref:"selector"},Ut,544),(0,i._)("div",{class:"textfield",contenteditable:"true",ref:"inputter",onKeydown:t[2]||(t[2]=(0,s.D2)((0,s.iM)(((...e)=>c.closeNodeAdder&&c.closeNodeAdder(...e)),["prevent"]),["enter"]))},null,544),(0,i._)("div",{class:"textfield-closer closer",onClick:t[3]||(t[3]=e=>c.closeNodeAdder())},Kt)],2)}const Yt=[];let Gt=1048577;for(let an=0;an<256;an++)for(let e=0;e<5;e++){Gt=(125*Gt+3)%2796203;const e=(65535&Gt)<<16,t=65535&Gt;Yt.push(e|t)}function zt(e){let t=2146271213,o=4008636142;for(let s of e){const e=s.charCodeAt();t=Yt[256+e]^t+o,o=e+t+o+(o<<5)+3}return t}function Pt(e){return new Promise(((t,o)=>{const s=new FileReader;e?(s.readAsDataURL(e),s.onload=()=>{const e=zt(s.result);t(e)}):(alert("图片文件获取失败"),o(null))}))}var Jt=o(196);const qt="/img-upload/";function Qt(e,t){const o=new FormData;return o.append("image",e,t),Jt.ZP.post(qt,o,{headers:"multipart/form-data"})}function Xt(e,t){return new Promise(((o,s)=>{const i=e.name.split(".")[1];Pt(e).then((o=>{const s=`${t.CT}-${o}.${i}`;return t.SRC=s,Qt(e,s)})).then((()=>{se.emit("show-msg","图片上传成功"),o(t)})).catch((()=>{alert("图片上传失败: "+e.name),s(null)}))}))}var eo=(e,t,o)=>{if(!t)return null;let s={NT:e};switch(e){case"h":case"p":case"li":s.CT=t,s.CL="#333";break;case"img":{const e=o.$refs.imgRev,i=e.files[0];return s.CT=t,Xt(i,s)}case"link":s.SRC=t,s.CT="",s.CL="#333";break;case"hr":break;case"floor":s.CTS=[{NT:"h",CT:t,CL:"#333"}];break;case"ol":s.NT="list",s.CTS=[{NT:"li",CT:t,CL:"#333"}],s.OL=!0;break;case"ul":s.NT="list",s.CTS=[{NT:"li",CT:t,CL:"#333"}],s.OL=!1;break;case"code":s.LG=t,s.CT="";break;case"table":s.CTS=[[t,"","",""],["","","",""]];break;case"details":s.SUM=t,s.CTS=[{CT:"",CL:"#333"}];break}return s};const to=["jpg","jpeg","png","webp","bmp","svg","gif","psd"];var oo={methods:{imgRevClear(){const e=this.$refs.imgRev;e.value=""},imgRevFunc(){const e=this.$refs.imgRev,t=e.files[0],o=t.name.split(".")[1];to.includes(o)||(alert("文件不是正确的图像文件"),this.imgRevClear())}}},so={props:["isAdding"],inject:["note"],mixins:[oo],methods:{focus(){const e=this.$refs.selector,t=this.$refs.inputter,o=this.$refs.imgRev;"img"==e.value&&o.click(),t.focus()},async closeNodeAdder(){const e=this.$refs.selector,t=this.$refs.inputter,o=e.value,s=t.innerText,i=await eo(o,s,this);this.$emit("return-node",i),t.blur(),t.innerText=""}}};const io=(0,H.Z)(so,[["render",Vt]]);var no=io,lo={components:{FloorBlock:Zt,NodeRenderer:At,TextfieldGroup:no},data(){return{isNodeAdding:!1}},props:["isFullscreen"],inject:["note"],created(){addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"a"==o&&(e.preventDefault(),this.openNodeAdder())}))},mounted(){this.$nextTick((()=>{Ce.init()})),se.on("note-loaded",(()=>{this.$nextTick((()=>{Ce.init()}))}))},methods:{openNodeAdder(){location.href="#note-textfield-group",this.isNodeAdding=!0,this.$nextTick((()=>{this.$refs.textfield.focus()}))},closeNodeAdder(e){this.isNodeAdding=!1;const t=this.note.CTS;if(e){t.push(e);const o=[t.length-1];se.emit("add-history",{loc:o,prop:"IST"})}}},watch:{isFullscreen(e,t){e!=t&&(this.$refs.note.style.display="none",setTimeout((()=>{this.$refs.note.style.display="block"}),1200))}}};const ao=(0,H.Z)(lo,[["render",ue],["__scopeId","data-v-68cfcc62"]]);var co=ao;function ro(e,t,o,s,n,l){const a=(0,i.up)("anchors-view",!0),c=(0,i.up)("drawer");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(c,{title:"笔记摘要",disabled:n.drawerDisabled,onCloseDrawer:t[0]||(t[0]=e=>n.drawerDisabled=!0)},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{list:n.anchorList},null,8,["list"])])),_:1},8,["disabled"])])}const ho={class:"titlebar shadow-4"},uo={class:"closer circle"},po={class:"drawer-view"};function mo(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,n.C_)(["fullscreen-mask",{disabled:o.disabled}]),onClick:t[0]||(t[0]=(...e)=>a.close&&a.close(...e))},null,2),(0,i._)("div",{class:(0,n.C_)(["drawer",{disabled:o.disabled}])},[(0,i._)("div",ho,[(0,i._)("div",uo,[(0,i._)("i",{class:"material-icons arrow-forward",onClick:t[1]||(t[1]=(...e)=>a.close&&a.close(...e))},"arrow_forward"),(0,i._)("i",{class:"material-icons arrow-upward",onClick:t[2]||(t[2]=(...e)=>a.close&&a.close(...e))},"arrow_upward")]),(0,i._)("h1",null,(0,n.zw)(o.title),1)]),(0,i._)("div",po,[(0,i.WI)(e.$slots,"default")])],2)],64)}var fo={props:["title","disabled"],emits:["close-drawer"],methods:{close(){this.$emit("close-drawer")}}};const bo=(0,H.Z)(fo,[["render",mo]]);var go=bo,vo={data(){return{drawerDisabled:!0,anchorList:[],timeout:null}},components:{Drawer:go,AnchorsView:{props:["list"],render(){let e=this.list.map((e=>(0,i.h)("a",{level:e.level,href:"#"+e.href},e.content)));return(0,i.h)("div",e)}}},inject:["note"],methods:{getAnchors(){const e=document.querySelectorAll(".heading");let t=[];for(let o of e)t.push({level:o.tagName,href:o.id,content:o.innerText});return t},close(){this.drawerDisabled=!0}},mounted(){se.on("open-anchors",(()=>{this.drawerDisabled=!1})),se.on("anchor-mounted",(()=>{this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout((()=>{this.anchorList=this.getAnchors()}))}))}};const wo=(0,H.Z)(vo,[["render",ro]]);var To=wo;const Co=e=>((0,i.dD)("data-v-c8fd90ac"),e=e(),(0,i.Cn)(),e),_o=Co((()=>(0,i._)("div",{class:"block"},[(0,i._)("div",{class:"mask"}),(0,i._)("i",{class:"material-icons"},"apps")],-1))),ko=Co((()=>(0,i._)("i",{class:"material-icons"},"subtitles",-1))),No=[ko],yo={class:"material-icons"},xo={class:"material-icons"},Lo=Co((()=>(0,i._)("i",{class:"material-icons"},"touch_app",-1))),Mo=[Lo],jo={class:"material-icons"},Do={class:"material-icons"};function So(e,t,o,l,a,c){return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["controlballs",{fullscreen:o.isFullscreen}])},[_o,(0,i._)("div",{class:"ball btn",onClick:t[0]||(t[0]=(...e)=>c.openAnchors&&c.openAnchors(...e))},No),(0,i._)("div",{class:"ball btn",onClick:t[1]||(t[1]=t=>e.$emit("toggle-darkMode"))},[(0,i.wy)((0,i._)("i",yo,"brightness_2",512),[[s.F8,!o.isDarkMode]]),(0,i.wy)((0,i._)("i",xo,"wb_sunny",512),[[s.F8,o.isDarkMode]])]),(0,i._)("div",{class:(0,n.C_)(["ball btn",{black:o.isTouchMode}]),onClick:t[2]||(t[2]=t=>e.$emit("toggle-touchMode"))},Mo,2),(0,i._)("div",{class:"ball btn",onClick:t[3]||(t[3]=t=>e.$emit("toggle-fullscreen"))},[(0,i.wy)((0,i._)("i",jo,"fullscreen",512),[[s.F8,!o.isFullscreen]]),(0,i.wy)((0,i._)("i",Do,"fullscreen_exit",512),[[s.F8,o.isFullscreen]])])],2)}var Oo={props:["isDarkMode","isTouchMode","isFullscreen"],emits:["toggle-darkMode","toggle-touchMode","toggle-fullscreen"],methods:{openAnchors(){se.emit("open-anchors")}}};const Fo=(0,H.Z)(Oo,[["render",So],["__scopeId","data-v-c8fd90ac"]]);var Io=Fo;const $o=e=>((0,i.dD)("data-v-1743cc7c"),e=e(),(0,i.Cn)(),e),Eo={class:"uploader"},Ao=$o((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),Wo=[Ao],Ro={class:"note-view-outer"},Zo={class:"note-view"},Ho={class:"input-group"},Uo={class:"buttons shadow-3"},Bo=$o((()=>(0,i._)("i",{class:"material-icons"},"cloud_upload",-1))),Ko=[Bo],Vo=$o((()=>(0,i._)("i",{class:"material-icons"},"file_download",-1))),Yo=[Vo],Go=$o((()=>(0,i._)("i",{class:"material-icons"},"create_new_folder",-1))),zo=[Go],Po=$o((()=>(0,i._)("i",{class:"material-icons"},"delete_forever",-1))),Jo=[Po];function qo(e,t,o,n,l,a){const c=(0,i.up)("uploader-list"),d=(0,i.up)("textfield-group"),r=(0,i.up)("window");return(0,i.wg)(),(0,i.j4)(r,{width:"800px",height:"480px",disabled:l.disabled,onClose:t[7]||(t[7]=e=>l.disabled=!0)},{default:(0,i.w5)((()=>[(0,i._)("div",Eo,[(0,i._)("div",{class:"closer shadow-1",onClick:t[0]||(t[0]=e=>l.disabled=!0)},Wo),(0,i._)("div",Ro,[(0,i._)("div",Zo,[(0,i.Wm)(c,{list:l.noteList},null,8,["list"]),(0,i.Wm)(d,{onReturnNode:e.creatFolder,isAdding:l.addingFolder,ref:"textfieldGroup"},null,8,["onReturnNode","isAdding"])])]),(0,i._)("div",Ho,[(0,i.wy)((0,i._)("input",{class:"inputter",type:"text",placeholder:"笔记名",maxlength:"20","onUpdate:modelValue":t[1]||(t[1]=e=>a.note.NM=e)},null,512),[[s.nr,a.note.NM]]),(0,i.wy)((0,i._)("input",{class:"inputter",type:"password",placeholder:"密码",maxlength:"10","onUpdate:modelValue":t[2]||(t[2]=e=>l.password=e)},null,512),[[s.nr,l.password]])]),(0,i._)("div",Uo,[(0,i._)("div",{class:"btn btn-shallow",onClick:t[3]||(t[3]=(...t)=>e.upload&&e.upload(...t))},Ko),(0,i._)("div",{class:"btn btn-shallow",onClick:t[4]||(t[4]=(...t)=>e.download&&e.download(...t))},Yo),(0,i._)("div",{class:"btn btn-shallow",onClick:t[5]||(t[5]=(...e)=>a.toCreatFolder&&a.toCreatFolder(...e))},zo),(0,i._)("div",{class:"btn btn-shallow",onClick:t[6]||(t[6]=(...t)=>e.deleteFile&&e.deleteFile(...t))},Jo)])])])),_:1},8,["disabled"])}const Qo=e=>((0,i.dD)("data-v-e47aff0c"),e=e(),(0,i.Cn)(),e),Xo=Qo((()=>(0,i._)("div",{class:"no-note"},"暂无笔记",-1))),es=[Xo],ts={class:"note-list",ref:"noteList"};function os(e,t,o,n,l,a){const c=(0,i.up)("uploader-list-folder"),d=(0,i.up)("uploader-list-file");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.wy)((0,i._)("div",null,es,512),[[s.F8,!o.list.length]]),(0,i._)("ul",ts,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.list,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["object"==typeof e?((0,i.wg)(),(0,i.j4)(c,{key:0,location:[t],name:e[0],list:e[1]},null,8,["location","name","list"])):((0,i.wg)(),(0,i.j4)(d,{key:1,location:[t],name:e},null,8,["location","name"]))],64)))),128))],512)],64)}const ss={class:"folder-item"},is={class:"item-name"},ns={class:"folder"};function ls(e,t,o,l,a,c){const d=(0,i.up)("uploader-list-folder",!0),r=(0,i.up)("uploader-list-file");return(0,i.wg)(),(0,i.iD)("li",ss,[(0,i._)("div",{class:(0,n.C_)(["item",{selected:e.selected}]),onClick:t[1]||(t[1]=(...e)=>c.collapse&&c.collapse(...e))},[(0,i._)("i",{class:"item-avatar material-icons",onClick:t[0]||(t[0]=(0,s.iM)(((...t)=>e.select&&e.select(...t)),["stop"]))},"folder_open"),(0,i._)("span",is,(0,n.zw)(o.name),1)],2),(0,i.wy)((0,i._)("ul",ns,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.list,((e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:e.id},["object"==typeof e?((0,i.wg)(),(0,i.j4)(d,{key:0,location:o.location.concat([t]),name:e[0],list:e[1]},null,8,["location","name","list"])):((0,i.wg)(),(0,i.j4)(r,{key:1,location:o.location.concat([t]),name:e},null,8,["location","name"]))],64)))),128))],512),[[s.F8,!a.collapsed]])])}var as={data(){return{selected:!1}},inject:["selectedItem"],methods:{select(){this.selected?(this.selected=!1,this.selectedItem.loc=[],this.selectedItem.type="",this.selectedItem.obj=null):(this.selected=!0,this.selectedItem.obj&&(this.selectedItem.obj.selected=!1),this.selectedItem.loc=this.location,this.selectedItem.type=this.type,this.selectedItem.obj=this)}}};const cs=(0,i._)("i",{class:"item-avatar material-icons"},"assignment",-1),ds={class:"item-name"};function rs(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("li",{class:(0,n.C_)(["item",{selected:e.selected}]),onClick:t[0]||(t[0]=(...t)=>e.select&&e.select(...t))},[cs,(0,i._)("span",ds,(0,n.zw)(o.name),1)],2)}var hs={props:["location","name"],mixins:[as],data(){return{type:"file"}}};const us=(0,H.Z)(hs,[["render",rs]]);var ps=us,ms={name:"uploader-list-folder",components:{UploaderListFile:ps},mixins:[as],props:["location","name","list"],data(){return{type:"folder",collapsed:!0}},methods:{collapse(){this.collapsed=!this.collapsed}}};const fs=(0,H.Z)(ms,[["render",ls],["__scopeId","data-v-3eae6352"]]);var bs=fs,gs={props:["list"],emits:["file-select"],components:{UploaderListFolder:bs,UploaderListFile:ps}};const vs=(0,H.Z)(gs,[["render",os],["__scopeId","data-v-e47aff0c"]]);var ws=vs;function Ts(e){let t;return t="string"==typeof e?e:e[0],t}var Cs={methods:{getTargetName(){const e=this.selected.loc,t=this.noteList;let o;if(1==e.length){const s=e[0],i=t[s];o=Ts(i)}else{let s;o=[];for(let i in e){const n=e[i];s=0==i?t[n]:s[1][n];const l=Ts(s);o.push(l)}o=o.join("/")}return o}}},_s={mixins:[Cs],methods:{upload(){const e=this.note.NM;let t,o;this.selected.obj&&"folder"==this.selected.type&&(t=this.selected.loc,o=this.getTargetName());const s={NM:this.note.NM,CTS:this.note.CTS};Jt.ZP.put("/api/upload",{note:JSON.stringify(s),folderLoc:t,folderName:o,noteName:e,password:this.password}).then((e=>{e.data.code?se.emit("show-msg",e.data.msg):(e.data.isNew&&(this.noteList=e.data.noteList),se.emit("show-msg","笔记上传成功。"))})).catch((e=>{console.warn(e),se.emit("show-msg","笔记上传请求失败。")}))},download(){if(!this.selected.obj)return void alert("请选择文件！");const e=this.selected.type;if("folder"==e)return void alert("不能下载文件夹。");const t=this.selected.loc,o=this.getTargetName();Jt.ZP.post("/api/download",{location:t,name:o,type:e,password:this.password}).then((e=>{if(e.data.code)5==e.data.code?(this.noteList=e.data.noteList,se.emit("show-msg",e.data.msg)):se.emit("show-msg",e.data.msg);else{se.emit("show-msg","笔记下载成功。");let t=confirm("将覆盖当前笔记，是否继续？");if(t){const t=e.data.noteContent,o=JSON.parse(t);this.note.NM=o.NM,this.note.CTS=o.CTS,se.emit("note-loaded"),document.title=`${o.NM} -- BNotee`}}})).catch((e=>{console.warn(e),se.emit("下载文件请求错误！")}))},creatFolder(e){if(this.addingFolder=!1,!e)return;const t=e.CT;let o,s;this.selected.obj&&"folder"==this.selected.type&&(o=this.selected.loc,s=this.getTargetName()),Jt.ZP.post("/api/create-folder",{folderName:s,folderLoc:o,name:t,password:this.password}).then((e=>{e.data.code?se.emit("show-msg",e.data.msg):(se.emit("show-msg","文件夹创建成功。"),this.noteList=e.data.noteList)})).catch((e=>{console.warn(e),se.emit("创建文件夹请求错误。")}))},deleteFile(){const e=confirm("此操作无法撤销，你确定吗？");if(e)if(this.selected.obj){const e=this.getTargetName(),t=this.selected.type,o=this.selected.loc;Jt.ZP["delete"]("/api/delete",{data:{name:e,type:t,location:o,password:this.password}}).then((e=>{e.data.code?5==e.data.code?(this.noteList=e.data.noteList,se.emit("show-msg",e.data.msg)):se.emit("show-msg",e.data.msg):(this.noteList=e.data.noteList,se.emit("show-msg","文件删除成功。"))})).catch((e=>{console.warn(e),se.emit("删除文件请求错误。")}))}else alert("请选择文件或文件夹。")}}},ks={components:{Window:B,UploaderList:ws,TextfieldGroup:no},mixins:[_s,Cs],inject:["note"],data(){return{disabled:!0,selected:{loc:[],type:"",obj:null},addingFolder:!1,password:"",noteList:[]}},provide(){return{selectedItem:this.selected}},methods:{toCreatFolder(){this.addingFolder=!0,this.$nextTick((()=>{this.$refs.textfieldGroup.focus()}))},show(){this.getTargetName()}},mounted(){se.on("open-uploader",(()=>{if(this.disabled=!1,!this.noteList.length){const e=(new Date).getTime();Jt.ZP.get(`/note-list?timestamp=${e}`).then((e=>{this.noteList=e.data.noteList})).catch((()=>{se.emit("show-msg","笔记列表获取错误。")}))}}))}};const Ns=(0,H.Z)(ks,[["render",qo],["__scopeId","data-v-1743cc7c"]]);var ys=Ns;function xs(e,t,o,s,n,l){const a=(0,i.up)("textfield-group-fixed"),c=(0,i.up)("colors"),d=(0,i.up)("table-setter"),r=(0,i.up)("history");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(a,{onClose:l.close,disabled:n.textfieldGroupDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(c,{onClose:l.close,disabled:n.colorsDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(d,{onClose:l.close,disabled:n.tableSetterDisabled},null,8,["onClose","disabled"]),(0,i.Wm)(r,{disabled:n.historyDisabled},null,8,["disabled"])])}const Ls={class:"textfield-group fixed-component fixed"},Ms=(0,i._)("option",{value:"h"},"标题",-1),js=(0,i._)("option",{value:"p"},"段落",-1),Ds=(0,i._)("option",{value:"img"},"图片",-1),Ss=(0,i._)("option",{value:"link"},"链接",-1),Os=(0,i._)("option",{value:"hr"},"割线",-1),Fs=(0,i._)("option",{value:"floor"},"层次",-1),Is=(0,i._)("option",{value:"ol"},"序列",-1),$s=(0,i._)("option",{value:"ul"},"乱列",-1),Es=(0,i._)("option",{value:"code"},"代码",-1),As=(0,i._)("option",{value:"table"},"表格",-1),Ws=(0,i._)("option",{value:"details"},"详情",-1),Rs=[Ms,js,Ds,Ss,Os,Fs,Is,$s,Es,As,Ws],Zs={class:"selector",ref:"selector4List"},Hs=(0,i._)("option",{value:"li"},"列项",-1),Us=(0,i._)("option",{value:"ol"},"序列",-1),Bs=(0,i._)("option",{value:"ul"},"乱列",-1),Ks=[Hs,Us,Bs],Vs=(0,i._)("i",{class:"material-icons"},"close",-1),Ys=[Vs];function Gs(e,t,o,n,l,a){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Ls,[(0,i._)("input",{onChange:t[0]||(t[0]=(...t)=>e.imgRevFunc&&e.imgRevFunc(...t)),type:"file",ref:"imgRev",style:{display:"none"}},null,544),(0,i.wy)((0,i._)("select",{onChange:t[1]||(t[1]=(...e)=>a.focus&&a.focus(...e)),class:"selector",ref:"selector"},Rs,544),[[s.F8,!a.isFromNestedList]]),(0,i.wy)((0,i._)("select",Zs,Ks,512),[[s.F8,a.isFromNestedList]]),(0,i._)("div",{class:"textfield",ref:"inputter",contenteditable:"true",onKeydown:t[2]||(t[2]=(0,s.D2)(((...e)=>a.onEnter&&a.onEnter(...e)),["enter"]))},null,544),(0,i._)("div",{class:"textfield-closer closer",onClick:t[3]||(t[3]=(...e)=>a.closeTextfield&&a.closeTextfield(...e))},Ys)],512),[[s.F8,!o.disabled]])])),_:1})}var zs={data(){return{commandFrom:""}},props:["disabled"],inject:["selectedNode"],mixins:[oo],computed:{isFromNestedList(){return"list"==this.commandFrom||["li","nestedList"].includes(this.selectedNode.type)}},mounted(){se.on("textfield-open",(e=>{this.commandFrom=e,setTimeout((()=>{this.focus()}),600)}))},methods:{onEnter(e){e.altKey&&(e.preventDefault(),this.closeTextfield())},focus(){const e=this.$refs.selector,t=this.$refs.inputter,o=this.$refs.imgRev;"img"==e.value&&o.click(),t.focus()},async closeTextfield(){this.$emit("close","textfieldGroup");const e=this.isFromNestedList?this.$refs.selector4List.value:this.$refs.selector.value,t=this.$refs.inputter.innerText,o=await eo(e,t,this);se.emit("textfield-return-"+this.commandFrom,o),this.$refs.inputter.blur(),this.$refs.inputter.innerText=""}}};const Ps=(0,H.Z)(zs,[["render",Gs]]);var Js=Ps;const qs=e=>((0,i.dD)("data-v-9ab59f84"),e=e(),(0,i.Cn)(),e),Qs={class:"colors fixed-component"},Xs=["onClick"],ei={class:"input-group"},ti=qs((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),oi=[ti];function si(e,t,o,l,a,c){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Qs,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.colors,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,class:"color btn btn-shallow",style:(0,n.j5)({"background-color":e}),onClick:t=>c.setColor(e)},null,12,Xs)))),128)),(0,i._)("div",ei,[(0,i._)("div",{class:"hint",onClick:t[0]||(t[0]=t=>e.$refs.colorInputter.click())},"#"),(0,i.wy)((0,i._)("input",{type:"color",ref:"colorInputter","onUpdate:modelValue":t[1]||(t[1]=e=>a.colorValue=e)},null,512),[[s.F8,!1],[s.nr,a.colorValue]]),(0,i.wy)((0,i._)("input",{class:"inputter",placeholder:"******",type:"text",maxlength:"8","onUpdate:modelValue":t[2]||(t[2]=e=>a.colorValue=e)},null,512),[[s.nr,a.colorValue]])]),(0,i._)("div",{class:"closer",onClick:t[3]||(t[3]=t=>e.$emit("close","colors"))},oi)],512),[[s.F8,!o.disabled]])])),_:1})}var ii={data(){return{colors:["#D50000","#FFD600","#333"],colorValue:"",timeout:null}},props:["disabled"],inject:["selectedNode"],mixins:[P],methods:{getColor(){const e=this.selectedNode.obj,t=e.CL;this.colorValue=t},setColor(e){const t=this.selectedNode.loc,o=this.selectedNode.obj,s=o.CL;o.CL=e,se.emit("add-history",{loc:t,prop:"CL",before:s,after:e})}},watch:{colorValue(e){clearTimeout(this.timeout),this.colorValue=e.replace("#",""),this.timeout=setTimeout((()=>{this.setColor("#"+this.colorValue)}),300)},disabled(e){e||this.getColor()}}};const ni=(0,H.Z)(ii,[["render",si],["__scopeId","data-v-9ab59f84"]]);var li=ni;const ai=e=>((0,i.dD)("data-v-75915245"),e=e(),(0,i.Cn)(),e),ci={class:"table-setter fixed-component"},di={class:"input-group"},ri=ai((()=>(0,i._)("i",{class:"hint material-icons"},"view_headline",-1))),hi={class:"input-group"},ui=ai((()=>(0,i._)("i",{class:"hint material-icons"},"view_column",-1))),pi=ai((()=>(0,i._)("i",{class:"material-icons"},"check",-1))),mi=[pi],fi=ai((()=>(0,i._)("i",{class:"material-icons"},"close",-1))),bi=[fi];function gi(e,t,o,n,l,a){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",ci,[(0,i._)("div",di,[ri,(0,i.wy)((0,i._)("input",{class:"inputter",type:"text",placeholder:" > 0 ","onUpdate:modelValue":t[0]||(t[0]=e=>l.row=e)},null,512),[[s.nr,l.row]])]),(0,i._)("div",hi,[ui,(0,i.wy)((0,i._)("input",{class:"inputter",type:"text",placeholder:" > 0 ",maxlength:"3","onUpdate:modelValue":t[1]||(t[1]=e=>l.col=e)},null,512),[[s.nr,l.col]])]),(0,i._)("div",{class:"closer",onClick:t[2]||(t[2]=(...e)=>a.tableSet&&a.tableSet(...e))},mi),(0,i._)("div",{class:"closer",onClick:t[3]||(t[3]=t=>e.$emit("close","tableSetter"))},bi)],512),[[s.F8,!o.disabled]])])),_:1})}var vi={data(){return{row:1,col:1,targetNode:null,targetNodeLoc:[],timeout:null}},props:["disabled"],mixins:[P],mounted(){const e={ROW:"row",COL:"col"};se.on("table-location",(e=>{this.tableGet(e)})),se.on("table-edit",(({historyObj:t,resultValue:o})=>{this.tableGet(t.loc);const s=e[t.prop];this[s]=t[o],this.tableSet(!1)}))},methods:{eventListen(e){const t=e.key;"Enter"==t&&this.tableSet(!0)},tableGet(e){e&&(this.targetNodeLoc=e,this.getNodeObj({location:e,callback:(e,t)=>{this.targetNode=e[t]}})),this.row=this.targetNode.CTS.length,this.col=this.targetNode.CTS[0].length},tableSet(e){const t=this.targetNode.CTS.length,o=this.targetNode.CTS[0].length,s=Math.abs(this.row-t),i=Math.abs(this.col-o);if(this.col!=o)if(e&&se.emit("add-history",{loc:this.targetNodeLoc,prop:"COL",before:o,after:this.col}),this.col>o)for(let n of this.targetNode.CTS)for(let e=0;e<i;e++)n.push("");else for(let n of this.targetNode.CTS)for(let e=0;e<i;e++)n.pop();if(this.row!=t)if(e&&se.emit("add-history",{loc:this.targetNodeLoc.loc,prop:"ROW",before:t,after:this.row}),this.row>t){let e=[];for(let t=0;t<this.col;t++)e.push("");for(let t=0;t<s;t++)this.targetNode.CTS.push([...e])}else for(let n=0;n<s;n++)this.targetNode.CTS.pop()}},watch:{disabled(e){e?(this.targetNode=null,this.targetNodeLoc=[],removeEventListener("keydown",this.eventListen)):addEventListener("keydown",this.eventListen)},row(e){e<1?this.timeout=setTimeout((()=>{this.row=1}),1e3):clearTimeout(this.timeout)},col(e){e<1?this.timeout=setTimeout((()=>{this.col=1}),1e3):clearTimeout(this.timeout)}}};const wi=(0,H.Z)(vi,[["render",gi],["__scopeId","data-v-75915245"]]);var Ti=wi;const Ci=e=>((0,i.dD)("data-v-6217a73f"),e=e(),(0,i.Cn)(),e),_i={class:"history fixed-component"},ki=Ci((()=>(0,i._)("i",{class:"material-icons"},"undo",-1))),Ni=[ki],yi=Ci((()=>(0,i._)("i",{class:"material-icons"},"redo",-1))),xi=[yi],Li=Ci((()=>(0,i._)("i",{class:"material-icons"},"menu",-1))),Mi=[Li];function ji(e,t,o,l,a,c){const d=(0,i.up)("history-view"),r=(0,i.up)("drawer");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",_i,[(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:a.historyIndex==c.note.HT.length-1}]),onClick:t[0]||(t[0]=e=>c.doit("undo"))},Ni,2),(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:a.historyIndex<0}]),onClick:t[1]||(t[1]=e=>c.doit("redo"))},xi,2),(0,i._)("div",{class:(0,n.C_)(["btn btn-shallow",{disabled:!c.note.HT.length}]),onClick:t[2]||(t[2]=e=>a.drawerDisabled=!1)},Mi,2)],512),[[s.F8,!o.disabled]])])),_:1}),(0,i.Wm)(r,{title:"编辑历史",disabled:a.drawerDisabled,onCloseDrawer:t[3]||(t[3]=e=>a.drawerDisabled=!0)},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{list:c.note.HT,index:a.historyIndex},null,8,["list","index"])])),_:1},8,["disabled"])],64)}o(541);const Di=e=>((0,i.dD)("data-v-45d2a3a0"),e=e(),(0,i.Cn)(),e),Si=Di((()=>(0,i._)("span",{class:"history-prop"},"位置：",-1))),Oi={class:"loc"},Fi=Di((()=>(0,i._)("span",{class:"history-prop"},"属性：",-1))),Ii={class:"prop"},$i=Di((()=>(0,i._)("span",{class:"history-prop"},"改前：",-1))),Ei=["title"],Ai=Di((()=>(0,i._)("span",{class:"history-prop"},"改后：",-1))),Wi=["title"],Ri=["data-index"];function Zi(e,t,o,l,a,c){return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.list,((e,o)=>((0,i.wg)(),(0,i.iD)("div",{class:"history-block",key:e.id,ref_for:!0,ref:"historyBlock"},[(0,i._)("div",null,[Si,(0,i._)("span",Oi,(0,n.zw)(e.loc),1)]),(0,i._)("div",null,[Fi,(0,i._)("span",Ii,(0,n.zw)(a.propsDict[e.prop]),1)]),(0,i.wy)((0,i._)("div",null,[$i,(0,i._)("span",{class:"text",title:e.before},(0,n.zw)(e.before),9,Ei)],512),[[s.F8,e.before]]),(0,i.wy)((0,i._)("div",null,[Ai,(0,i._)("span",{class:"text",title:e.after},(0,n.zw)(e.after),9,Wi)],512),[[s.F8,e.after]]),(0,i._)("div",{class:"btn btn-shallow",onClick:t[0]||(t[0]=(...e)=>c.doSome&&c.doSome(...e))},[(0,i._)("i",{class:"material-icons","data-index":o},"check",8,Ri)])])))),128)}var Hi={props:["list","index"],data(){return{propsDict:{CT:"内容",CL:"颜色",SUM:"题目",ROW:"行数",COL:"列数",IST:"插入",DEL:"删除"}}},methods:{doSome(e){const t=e.target,o=t.dataset["index"],s=this.$parent.$parent;s.doSome(o)}},watch:{index(e,t){const o=this.$el.parentNode,s=o.children[e],i=o.children[t];e>-1&&s.classList.add("selected"),t>-1&&i.classList.remove("selected")}}};const Ui=(0,H.Z)(Hi,[["render",Zi],["__scopeId","data-v-45d2a3a0"]]);var Bi=Ui,Ki={data(){return{drawerDisabled:!0,historyIndex:-1}},components:{Drawer:go,HistoryView:Bi},props:["disabled"],inject:["note","selectedNode"],mixins:[P,J,q],methods:{doit(e){const t="undo"==e?++this.historyIndex:this.historyIndex--;let o=this.note.HT[t];const s="undo"==e?"before":"after";switch(o.prop){case"CT":case"CL":case"SUM":this.getNodeObj({location:o.loc,callback:(e,t)=>{const i=e[t];i[o.prop]=o[s]}});break;case"ROW":case"COL":se.emit("table-edit",{historyObj:o,resultValue:s});break;case"IST":{const e=o.loc,t=this.deleteNode(e);o.prop="DEL",o.loc[o.loc.length-1]-=1,o.nodeObj=t;break}case"DEL":{const e=o.nodeObj,t=o.loc;this.insertNode(e,t),o.prop="IST",o.loc[o.loc.length-1]+=1;break}}},doSome(e){const t=e-this.historyIndex,o=Math.abs(t);let s;if(t>0)s="undo";else{if(!(t<0))return;s="redo"}for(let i=0;i<o;i++)this.doit(s)}},mounted(){addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"z"==o&&this.doit("undo")})),addEventListener("keydown",(e=>{const t=e.altKey,o=e.key;t&&"y"==o&&this.doit("redo")})),se.on("add-history",(e=>{const t=this.note.HT;if(20==t.length&&t.pop(),this.historyIndex<0)t.unshift(e);else{const o=this.historyIndex+1;t.splice(0,o),t.unshift(e),this.historyIndex=-1}})),se.on("clear-history",(()=>{this.historyIndex=-1}))}};const Vi=(0,H.Z)(Ki,[["render",ji],["__scopeId","data-v-6217a73f"]]);var Yi=Vi,Gi={data(){return{textfieldGroupDisabled:!0,colorsDisabled:!0,tableSetterDisabled:!0,historyDisabled:!1}},components:{TextfieldGroupFixed:Js,Colors:li,TableSetter:Ti,History:Yi},methods:{open(e){this.closeAll(),this[e+"Disabled"]=!1},close(e){this[e+"Disabled"]=!0,this.historyDisabled=!1},closeAll(){this.colorsDisabled=!0,this.textfieldGroupDisabled=!0,this.tableSetterDisabled=!0,this.historyDisabled=!0}},mounted(){se.on("fixedComponents-open",this.open),se.on("textfield-open",(()=>{this.open("textfieldGroup")})),se.on("fixedComponents-close",(()=>{this.closeAll(),this.historyDisabled=!1}))}};const zi=(0,H.Z)(Gi,[["render",xs],["__scopeId","data-v-18e0962a"]]);var Pi=zi;const Ji={class:"msgbar-outer"};function qi(e,t,o,l,a,c){return(0,i.wg)(),(0,i.j4)(s.uT,{name:"slide"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Ji,[(0,i._)("div",{class:(0,n.C_)(["msgbar",{active:a.active}]),onClick:t[0]||(t[0]=(...e)=>c.close&&c.close(...e))},(0,n.zw)(a.msg),3)],512),[[s.F8,a.active]])])),_:1})}var Qi={data(){return{active:!1,msg:""}},methods:{close(){this.active=!1}},mounted(){se.on("show-msg",(e=>{this.msg=e,this.active=!0}))},watch:{active(e){e&&setTimeout((()=>{this.close()}),3e3)}}};const Xi=(0,H.Z)(Qi,[["render",qi]]);var en=Xi,tn={NM:"Example",HT:[],CTS:[{NT:"h",CT:"这是一个大标题",CL:"#333"},{NT:"img",SRC:"logo.png",CT:"logo image"},{NT:"hr"},{NT:"p",CT:"这是一个段落",CL:"#333"},{NT:"p",CT:"内联样式实例（均使用英文符号）：##粗体## ``代码`` __下划线__ //斜体// --删除-- ::淡化::",CL:"#333"},{NT:"link",CT:"一个链接",SRC:"https://www.bing.com",CL:"#333"},{NT:"floor",CTS:[{NT:"h",CT:"这是层次中的大标题",CL:"#333"},{NT:"p",CT:"这是一个段落",CL:"#333"},{NT:"floor",CTS:[{NT:"h",CT:"这是层次中的大标题",CL:"#333"},{NT:"p",CT:"这是一个段落",CL:"#333"}]}]},{NT:"list",OL:!0,CTS:[{NT:"li",CT:"这是一个列表项",CL:"#333"},{NT:"li",CT:"这是一个列表项",CL:"#333"},{NT:"list",OL:!1,CTS:[{NT:"li",CT:"嵌套列表内的列表项",CL:"#333"},{NT:"li",CT:"嵌套列表内的列表项",CL:"#333"}]}]},{NT:"table",CTS:[["表格项","表格项","表格项","表格项"],["表格项","表格项","表格项","表格项"]]},{NT:"details",SUM:"这是一个详情块",CTS:[{CT:"这是一个段落",CL:"#333"},{CT:"这是一个段落",CL:"#333"}]},{NT:"code",LG:"javascript",CT:"console.log('Hello World')\nalert('Hello World')"}]},on={name:"App",components:{Anchors:To,Note:co,Uploader:ys,ControlBalls:Io,ToolBar:ce,Msgbar:en,FixedComponents:Pi},data(){return{windowDisabled:!1,note:tn,selectedNode:{loc:null,obj:null,vnode:null,type:null},isDarkMode:!1,isTouchMode:!1,isFullscreen:!1}},provide(){return{note:this.note,selectedNode:this.selectedNode,isDarkMode:(0,i.Fl)((()=>this.isDarkMode)),isTouchMode:(0,i.Fl)((()=>this.isTouchMode))}},mounted(){this.$nextTick((()=>{const e=()=>{const e=document.querySelector("#meta-viewport");let t;window&&(t=window.outerHeight);const o=`width=device-width,height=${t},initial-scale=1.0`;e.setAttribute("content",o)};e(),addEventListener("orientationchange",(()=>{e()}))}))}};const sn=(0,H.Z)(on,[["render",l]]);var nn=sn;o(9029);const ln=(0,s.ri)(nn);ln.use(yt.Z),ln.config.unwrapInjectedRef=!0,ln.mount("#app")}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,s,i,n){if(!s){var l=1/0;for(r=0;r<e.length;r++){s=e[r][0],i=e[r][1],n=e[r][2];for(var a=!0,c=0;c<s.length;c++)(!1&n||l>=n)&&Object.keys(o.O).every((function(e){return o.O[e](s[c])}))?s.splice(c--,1):(a=!1,n<l&&(l=n));if(a){e.splice(r--,1);var d=i();void 0!==d&&(t=d)}}return t}n=n||0;for(var r=e.length;r>0&&e[r-1][2]>n;r--)e[r]=e[r-1];e[r]=[s,i,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,n,l=s[0],a=s[1],c=s[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(c)var r=c(o)}for(t&&t(s);d<l.length;d++)n=l[d],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(r)},s=self["webpackChunkBNotee"]=self["webpackChunkBNotee"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(534)}));s=o.O(s)})();
//# sourceMappingURL=app.50bc1817.js.map